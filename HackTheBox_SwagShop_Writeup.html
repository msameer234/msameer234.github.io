<!doctype html>
<html lang="en">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
  <title>&#991;&alpha;&Sigma;</title>
</head>
<body style="background-color: black;">
  <div class="container">
    <nav class="navbar navbar-expand-lg navbar-light" style="background-color: black;">
      <div style="font-weight: bold; "><a style="color: green;font-size: 30px;" class="navbar-brand" href="index.html" >&#991;&alpha;&Sigma;</a></div>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" style="border-color: green; border: 2">
        <span style="color: green;"><b>>></b></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="index.html" style="color: green;"	>Home <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="HackTheBox_SwagShop_Writeup.txt" style="color: green;">WriteUps</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="Resume.pdf" style="color: green;">Resume</a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="jumbotron" style="background-color: black; text-align:center;">   
      <h1 class="display-4"><img src="profile.jpg" class="avatar" style="height: 40%; width: 40%; border-radius: 50%;" alt="Avatar"></h1>    
    </div>

    <div class="body" style="text-align: center;">

    <div class="card mb-3" style="background-color: black; color: green; border-color: green; border: 2">
      <div class="card-body">
      <p class="card-text">
				       +=================================================================+
				       |",",",",",",",",",",",",","SwagShop",",",",",",",",",",",",",",",|
				       |",",",",",",",",",",",","10.10.10.140",",",",",",",",",",",",",",|
				       |",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",","|
				       |",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",","|
				       |",",",",",",",",",",",",",WALKTHROUGH,",",",",",",",",",",",",","|
				       |",",",",",",",",",",",",",",",",",",",",",",",",","(msameer234),"|
				       +=================================================================+

 
+====================================================================================================================================================+
|,",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",","SCANNING",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",|
+====================================================================================================================================================+
 nmap 10.10.10.140
	PORT   STATE SERVICE
	22/tcp open  ssh
	80/tcp open  http

+====================================================================================================================================================+
|,",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",ENUMERATION,",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",","|
+====================================================================================================================================================+

 Wibsite hosted on port 80/http --- SwagShop -- Shoping Site
	Using Magento CMS --- found it by wappalyzer.
	
	Found RCE of Magento: 
		command used: searchsploit Magento
			Magento eCommerce - Remote Code Execution  
			/usr/share/exploitdb/exploits/xml/webapps/37977.py
	Copy the exploit and edit it, then set your target: 
		e.g. target = "http://10.10.10.140/index.php/"
	and save it.
	
	Now execute it as:
		python exploit.py
		it creates an admin account with username "forme" and password "forme":
		Now login at : http://10.10.10.140/index.php/admin -->> Found this by Dirbuster
		I tried to upload php shell, but I couldn't.
		Then I found a way to create a new product-- added an option that asks user to upload a file with extension .php
	
	Now make an order of the created product and upload the file php-reverse-shell.
	And start multi-handler of uploaded shell on msfconsole

	Here you can access your uploaded shell on server: 
		http://10.10.10.140/media/custom_options/order/p/h/
		found media folder by dirbuster.. then did some search after uploading the shell..
		Set up listener and get the reverse_shell.

	Now navigate to /home/haris/

	there is user.txt fie which contains user flag: a448877277e82f05e5ddf9f90aefbac8

+====================================================================================================================================================+
|,",",",",",",",",",",",",",",",",",",",",",",",",",",",","PRIVILEGE-ESCALATION",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",",|
+====================================================================================================================================================+

Type Command:
	sudo -l and hit enter
Output:
	Matching Defaults entries for www-data on swagshop:
    		env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

	User www-data may run the following commands on swagshop:
    		(root) NOPASSWD: /usr/bin/vi /var/www/html/*

	
Here we found we can access all files from "/var/www/html/" directory and vi text editor from "/usr/bin/" directory with root privileges.

lets create a tty first as it is not there:
python3 is installed:
the command is: 
	python3 -c 'import pty;pty.spawn("/bin/sh")'

Now, lets edit any file from /var/www/html/ directory with vi using sudo:

cd /home/haris

sudo vi /var/www/html/../../../etc/sudoers

Now to enter into Command Mode and execute the command /bin/sh type in    :!/bin/sh     and hit enter

and we got root..

Navigating to /root/ directory..
cd /root
cat root.txt
c2b087d66e14a652a3b86a130ac56721

   ___ ___
 /| |/|\| |\
/_| Â´ |.` |_\           We are open! (Almost)
  |   |.  |
  |   |.  |         Join the beta HTB Swag Store!
  |___|.__|       https://hackthebox.store/password

                   PS: Use root flag as password!





And we got flag in root.txt file: c2b087d66e14a652a3b86a130ac56721

Finish..!!!
</p> <br>
      </div>
    </div>
    </div>
    <hr class="my-4">

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script type="text/javascript" src="profile.js" async defer></script>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
  </div>
</body>
</html>
